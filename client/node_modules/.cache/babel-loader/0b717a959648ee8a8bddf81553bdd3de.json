{"ast":null,"code":"import _regeneratorRuntime from\"/Users/roger/Projects/mechanic-frontend/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/roger/Projects/mechanic-frontend/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React from\"react\";import firebase from\"firebase\";import axios from\"axios\";function AuthCallback(props){firebase.auth().onAuthStateChanged(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user){var token;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!user){_context.next=8;break;}_context.next=3;return user.getIdToken();case 3:token=_context.sent;localStorage.setItem(\"token\",token);axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/users/auth\"),{user:user,token:token}).then(function(res){localStorage.setItem(\"id\",res.data.id);window.location=\"/home\";}).catch(function(err){// console.error(err);\nwindow.location=\"/login\";});_context.next=9;break;case 8:// User is signed out.\nwindow.location=\"/login\";case 9:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());return React.createElement(\"div\",{className:\"login\"});}export default AuthCallback;","map":{"version":3,"sources":["/Users/roger/Projects/mechanic-frontend/client/src/views/AuthCallback.js"],"names":["React","firebase","axios","AuthCallback","props","auth","onAuthStateChanged","user","getIdToken","token","localStorage","setItem","post","process","env","REACT_APP_API_URL","then","res","data","id","window","location","catch","err"],"mappings":"+PACA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,QAAP,KAAqB,UAArB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CAIA,QAASC,CAAAA,YAAT,CAAsBC,KAAtB,CAA6B,CACzBH,QAAQ,CAACI,IAAT,GAAgBC,kBAAhB,0FAAmC,iBAAMC,IAAN,gIAE3BA,IAF2B,+CAGTA,CAAAA,IAAI,CAACC,UAAL,EAHS,QAGvBC,KAHuB,eAI3BC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8BF,KAA9B,EAEAP,KAAK,CACAU,IADL,WACaC,OAAO,CAACC,GAAR,CAAYC,iBADzB,gBACyD,CACjDR,IAAI,CAAEA,IAD2C,CAEjDE,KAAK,CAAEA,KAF0C,CADzD,EAKKO,IALL,CAKU,SAAAC,GAAG,CAAI,CACTP,YAAY,CAACC,OAAb,CAAqB,IAArB,CAA2BM,GAAG,CAACC,IAAJ,CAASC,EAApC,EACAC,MAAM,CAACC,QAAP,CAAkB,OAAlB,CACH,CARL,EASKC,KATL,CASW,SAAAC,GAAG,CAAI,CACV;AACAH,MAAM,CAACC,QAAP,CAAkB,QAAlB,CACH,CAZL,EAN2B,6BAoB3B;AACAD,MAAM,CAACC,QAAP,CAAkB,QAAlB,CArB2B,sDAAnC,gEAyBA,MAAO,4BAAK,SAAS,CAAC,OAAf,EAAP,CACH,CAGD,cAAelB,CAAAA,YAAf","sourcesContent":["\nimport React from \"react\";\nimport firebase from \"firebase\";\nimport axios from \"axios\";\n\n\n\nfunction AuthCallback(props) {\n    firebase.auth().onAuthStateChanged(async user => {\n        // User is signed in.\n        if (user) {\n            let token = await user.getIdToken();\n            localStorage.setItem(\"token\", token);\n\n            axios\n                .post(`${process.env.REACT_APP_API_URL}/users/auth`, {\n                    user: user,\n                    token: token\n                })\n                .then(res => {\n                    localStorage.setItem(\"id\", res.data.id);\n                    window.location = \"/home\";\n                })\n                .catch(err => {\n                    // console.error(err);\n                    window.location = \"/login\";\n                });\n        } else {\n            // User is signed out.\n            window.location = \"/login\";\n        }\n    });\n\n    return <div className=\"login\" />;\n}\n\n\nexport default AuthCallback;\n"]},"metadata":{},"sourceType":"module"}