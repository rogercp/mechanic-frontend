{"ast":null,"code":"import _regeneratorRuntime from\"/Users/roger/Projects/mechanic-frontend/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/roger/Projects/mechanic-frontend/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React from'react';import{Route}from'react-router-dom';import firebase from'firebase';import uuid from'uuid';import axios from'axios';var PrivateRoute=function PrivateRoute(_ref){var Component=_ref.component,ErrorBoundary=_ref.errorBoundary,path=_ref.path,exact=_ref.exact;firebase.auth().onAuthStateChanged(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user){var displayName,email,emailVerified,photoURL,isAnonymous,uid,providerData,token;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!user){_context.next=15;break;}displayName=user.displayName;email=user.email;emailVerified=user.emailVerified;photoURL=user.photoURL;isAnonymous=user.isAnonymous;uid=user.uid;providerData=user.providerData;_context.next=10;return user.getIdToken();case 10:token=_context.sent;localStorage.setItem('token',token);axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/users/auth\"),{user:user,token:token}).then(function(res){localStorage.setItem('id',res.data.id);}).catch(function(err){console.log(err);});_context.next=15;break;case 15:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}());if(exact){return React.createElement(Route,{key:uuid.v4(),exact:true,path:path,render:function render(props){return React.createElement(ErrorBoundary,null,React.createElement(Component,props));}});}else{return React.createElement(Route,{key:uuid.v4(),path:path,render:function render(props){return React.createElement(ErrorBoundary,null,React.createElement(Component,props));}});}};export default PrivateRoute;","map":{"version":3,"sources":["/Users/roger/Projects/mechanic-frontend/client/src/routes/helpers/PrivateRoute.js"],"names":["React","Route","firebase","uuid","axios","PrivateRoute","Component","component","ErrorBoundary","errorBoundary","path","exact","auth","onAuthStateChanged","user","displayName","email","emailVerified","photoURL","isAnonymous","uid","providerData","getIdToken","token","localStorage","setItem","post","process","env","REACT_APP_API_URL","then","res","data","id","catch","err","console","log","v4","props"],"mappings":"+PACA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,KAAT,KAAsB,kBAAtB,CACA,MAAOC,CAAAA,QAAP,KAAqB,UAArB,CACA,MAAOC,CAAAA,IAAP,KAAiB,MAAjB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CAGA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,MAAyE,IAA3DC,CAAAA,SAA2D,MAAtEC,SAAsE,CAAjCC,aAAiC,MAAhDC,aAAgD,CAAlBC,IAAkB,MAAlBA,IAAkB,CAAZC,KAAY,MAAZA,KAAY,CAE1FT,QAAQ,CAACU,IAAT,GAAgBC,kBAAhB,2FAAmC,iBAAOC,IAAP,sMAC5BA,IAD4B,0BAIzBC,WAJyB,CAIXD,IAAI,CAACC,WAJM,CAKzBC,KALyB,CAKjBF,IAAI,CAACE,KALY,CAMzBC,aANyB,CAMTH,IAAI,CAACG,aANI,CAOzBC,QAPyB,CAOdJ,IAAI,CAACI,QAPS,CAQzBC,WARyB,CAQXL,IAAI,CAACK,WARM,CASzBC,GATyB,CASnBN,IAAI,CAACM,GATc,CAUzBC,YAVyB,CAUVP,IAAI,CAACO,YAVK,wBAaTP,CAAAA,IAAI,CAACQ,UAAL,EAbS,SAavBC,KAbuB,eAe3BC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA6BF,KAA7B,EAEAnB,KAAK,CAACsB,IAAN,WAAcC,OAAO,CAACC,GAAR,CAAYC,iBAA1B,gBAAyD,CACrDf,IAAI,CAACA,IADgD,CAErDS,KAAK,CAACA,KAF+C,CAAzD,EAGGO,IAHH,CAGQ,SAAAC,GAAG,CAAG,CACVP,YAAY,CAACC,OAAb,CAAqB,IAArB,CAA0BM,GAAG,CAACC,IAAJ,CAASC,EAAnC,EACH,CALD,EAKGC,KALH,CAKS,SAAAC,GAAG,CAAG,CACXC,OAAO,CAACC,GAAR,CAAYF,GAAZ,EACH,CAPD,EAjB2B,8EAAnC,iEA+BA,GAAIxB,KAAJ,CAAW,CACP,MAAO,qBAAC,KAAD,EAAO,GAAG,CAAER,IAAI,CAACmC,EAAL,EAAZ,CAAuB,KAAK,KAA5B,CAA6B,IAAI,CAAE5B,IAAnC,CAAyC,MAAM,CAAE,gBAAA6B,KAAK,QAC3D,qBAAC,aAAD,MACE,oBAAC,SAAD,CAAeA,KAAf,CADF,CAD2D,EAAtD,EAAP,CAKD,CANH,IAMS,CACL,MAAO,qBAAC,KAAD,EAAO,GAAG,CAAEpC,IAAI,CAACmC,EAAL,EAAZ,CAAuB,IAAI,CAAE5B,IAA7B,CAAmC,MAAM,CAAE,gBAAA6B,KAAK,QACrD,qBAAC,aAAD,MACE,oBAAC,SAAD,CAAeA,KAAf,CADF,CADqD,EAAhD,EAAP,CAKD,CAEN,CA/CD,CAmDA,cAAelC,CAAAA,YAAf","sourcesContent":["\nimport React from 'react';\nimport { Route } from 'react-router-dom';\nimport firebase from 'firebase';\nimport uuid from 'uuid';\nimport axios from 'axios';\n\n\nconst PrivateRoute = ({ component: Component, errorBoundary: ErrorBoundary, path, exact }) => {\n\n    firebase.auth().onAuthStateChanged(async (user)=>{\n        if(user){\n            \n\n          let displayName = user.displayName;\n          let email = user.email;\n          let emailVerified = user.emailVerified;\n          let photoURL = user.photoURL;\n          let isAnonymous = user.isAnonymous;\n          let uid = user.uid;\n          let providerData = user.providerData;\n    \n\n            let token = await user.getIdToken()\n\n            localStorage.setItem('token',token)\n\n            axios.post(`${process.env.REACT_APP_API_URL}/users/auth`,{\n                user:user,\n                token:token\n            }).then(res =>{\n                localStorage.setItem('id',res.data.id)\n            }).catch(err =>{\n                console.log(err)\n            });\n        }else {\n          // User is signed out.\n          // ...\n        }\n    })\n\n    if (exact) {\n        return <Route key={uuid.v4()} exact path={path} render={props => (\n          <ErrorBoundary>\n            <Component {...props} />\n          </ErrorBoundary>\n        )} />\n      } else {\n        return <Route key={uuid.v4()} path={path} render={props => (\n          <ErrorBoundary>\n            <Component {...props} />\n          </ErrorBoundary>\n        )} />\n      }\n\n}\n\n\n\nexport default PrivateRoute;\n"]},"metadata":{},"sourceType":"module"}